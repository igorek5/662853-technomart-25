var messageButton=document.querySelector(".contacts .button"),popupMessage=document.querySelector(".modal-message"),closeMessage=document.querySelector(".modal-message .modal-close"),userName=popupMessage.querySelector("[name=user]"),userEmail=popupMessage.querySelector("[name=email]"),form=popupMessage.querySelector(".message-form"),overlay=document.querySelector(".overlay"),mapLink=document.querySelector(".contacts-map"),mapPopup=document.querySelector(".modal-map"),mapClose=mapPopup.querySelector(".modal-close"),isStorageSupport=!0,storage="";try{storage=localStorage.getItem("userName")}catch(e){isStorageSupport=!1}messageButton.addEventListener("click",function(e){e.preventDefault(),popupMessage.classList.add("modal-show"),overlay.classList.add("active"),userName.focus(),storage?(userName.value=storage,userEmail.focus()):userName.focus()}),closeMessage.addEventListener("click",function(e){e.preventDefault(),popupMessage.classList.remove("modal-show"),popupMessage.classList.remove("modal-error"),overlay.classList.remove("active")}),form.addEventListener("submit",function(e){userName.value&&userEmail.value?isStorageSupport&&localStorage.setItem("userName",userName.value):(e.preventDefault(),popupMessage.classList.remove("modal-error"),popupMessage.offsetWidth=popupMessage.offsetWidth,popupMessage.classList.add("modal-error"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&popupMessage.classList.contains("modal-show")&&(e.preventDefault(),popupMessage.classList.remove("modal-show"),popupMessage.classList.remove("modal-error"),overlay.classList.remove("active"))}),mapLink.addEventListener("click",function(e){e.preventDefault(),mapPopup.classList.add("modal-active"),mapClose.focus()}),mapClose.addEventListener("click",function(e){e.preventDefault(),mapPopup.classList.remove("modal-active")}),window.addEventListener("keydown",function(e){27===e.keyCode&&mapPopup.classList.contains("modal-active")&&(e.preventDefault(),mapPopup.classList.remove("modal-active"))});